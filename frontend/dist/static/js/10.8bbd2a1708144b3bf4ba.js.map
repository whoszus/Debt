{"version":3,"sources":["webpack:///src/views/others/Excel.vue","webpack:///./src/views/others/Excel.vue?7e6a","webpack:///./src/views/others/Excel.vue"],"names":["Excel","components","ImportResult","data","fileList","importData","times","errors","uploading","importResultVisible","dataSource","paginationInfo","pagination","pageSizeOptions","defaultCurrent","defaultPageSize","showQuickJumper","showSizeChanger","showTotal","total","range","loading","computed","columns","title","dataIndex","mounted","this","fetch","methods","handleClose","downloadTemplate","$download","exportExcel","$export","handleRemove","file","$message","warning","index","indexOf","newFileList","slice","splice","beforeUpload","concat","toConsumableArray_default","handleUpload","_this","formData","FormData","append","$upload","then","r","length","error","time","catch","console","handleTableChange","filters","sorter","_this2","params","arguments","undefined","$refs","TableInfo","current","pageSize","pageNum","$get","extends_default","rows","others_Excel","render","_vm","_h","$createElement","_c","_self","staticStyle","width","staticClass","attrs","remove","disabled","type","_v","margin-right","on","click","_s","bordered","ref","scroll","x","change","close","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/10.8bbd2a1708144b3bf4ba.js","sourcesContent":["<template>\n  <div style=\"width: 100%\">\n    <div class=\"option-area\">\n       <a-upload\n         class=\"upload-area\"\n         :fileList=\"fileList\"\n         :remove=\"handleRemove\"\n         :disabled=\"fileList.length === 1\"\n         :beforeUpload=\"beforeUpload\">\n        <a-button>\n          <a-icon type=\"upload\" /> 选择.xlsx文件\n        </a-button>\n      </a-upload>\n      <div class=\"button-area\">\n        <a-button type=\"primary\" @click=\"downloadTemplate\" style=\"margin-right: .5rem\">\n          模板下载\n        </a-button>\n        <a-button @click=\"exportExcel\" style=\"margin-right: .5rem\">\n          导出Excel\n        </a-button>\n        <a-button\n          @click=\"handleUpload\"\n          :disabled=\"fileList.length === 0\"\n          :loading=\"uploading\">\n          {{uploading ? '导入中' : '导入Excel' }}\n        </a-button>\n      </div>\n    </div>\n    <a-card :bordered=\"false\" class=\"card-area\">\n      <!-- 表格区域 -->\n      <a-table ref=\"TableInfo\"\n               :columns=\"columns\"\n               :dataSource=\"dataSource\"\n               :pagination=\"pagination\"\n               :loading=\"loading\"\n               @change=\"handleTableChange\"\n               :scroll=\"{ x: 900 }\">\n      </a-table>\n    </a-card>\n    <import-result\n      @close=\"handleClose\"\n      :importData=\"importData\"\n      :errors=\"errors\"\n      :times=\"times\"\n      :importResultVisible=\"importResultVisible\">\n    </import-result>\n  </div>\n</template>\n<script>\nimport ImportResult from './ImportResult'\n\nexport default {\n  components: {ImportResult},\n  data () {\n    return {\n      fileList: [],\n      importData: [],\n      times: '',\n      errors: [],\n      uploading: false,\n      importResultVisible: false,\n      dataSource: [],\n      paginationInfo: null,\n      pagination: {\n        pageSizeOptions: ['10', '20', '30', '40', '100'],\n        defaultCurrent: 1,\n        defaultPageSize: 10,\n        showQuickJumper: true,\n        showSizeChanger: true,\n        showTotal: (total, range) => `显示 ${range[0]} ~ ${range[1]} 条记录，共 ${total} 条记录`\n      },\n      loading: false\n    }\n  },\n  computed: {\n    columns () {\n      return [{\n        title: '字段1',\n        dataIndex: 'field1'\n      }, {\n        title: '字段2',\n        dataIndex: 'field2'\n      }, {\n        title: '字段3',\n        dataIndex: 'field3'\n      }, {\n        title: '导入时间',\n        dataIndex: 'createTime'\n      }]\n    }\n  },\n  mounted () {\n    this.fetch()\n  },\n  methods: {\n    handleClose () {\n      this.importResultVisible = false\n    },\n    downloadTemplate () {\n      this.$download('test/template', {}, '导入模板.xlsx')\n    },\n    exportExcel () {\n      this.$export('test/export')\n    },\n    handleRemove (file) {\n      if (this.uploading) {\n        this.$message.warning('文件导入中，请勿删除')\n        return\n      }\n      const index = this.fileList.indexOf(file)\n      const newFileList = this.fileList.slice()\n      newFileList.splice(index, 1)\n      this.fileList = newFileList\n    },\n    beforeUpload (file) {\n      this.fileList = [...this.fileList, file]\n      return false\n    },\n    handleUpload () {\n      const { fileList } = this\n      const formData = new FormData()\n      formData.append('file', fileList[0])\n      this.uploading = true\n      this.$upload('test/import', formData).then((r) => {\n        let data = r.data.data\n        if (data.data.length) {\n          this.fetch()\n        }\n        this.importData = data.data\n        this.errors = data.error\n        this.times = data.time / 1000\n        this.uploading = false\n        this.fileList = []\n        this.importResultVisible = true\n      }).catch((r) => {\n        console.error(r)\n        this.uploading = false\n        this.fileList = []\n      })\n    },\n    handleTableChange (pagination, filters, sorter) {\n      this.paginationInfo = pagination\n      this.fetch()\n    },\n    fetch (params = {}) {\n      this.loading = true\n      if (this.paginationInfo) {\n        this.$refs.TableInfo.pagination.current = this.paginationInfo.current\n        this.$refs.TableInfo.pagination.pageSize = this.paginationInfo.pageSize\n        params.pageSize = this.paginationInfo.pageSize\n        params.pageNum = this.paginationInfo.current\n      } else {\n        params.pageSize = this.pagination.defaultPageSize\n        params.pageNum = this.pagination.defaultCurrent\n      }\n      this.$get('test', {\n        ...params\n      }).then((r) => {\n        let data = r.data\n        const pagination = { ...this.pagination }\n        pagination.total = data.total\n        this.loading = false\n        this.dataSource = data.rows\n        this.pagination = pagination\n      })\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n  @import \"../../../static/less/Common\";\n  .option-area {\n    display: inline-block;\n    width: 100%;\n    padding: 0 .9rem;\n    margin: .5rem 0;\n    .upload-area {\n      display: inline;\n      float: left;\n      width: 50%\n    }\n    .button-area {\n      margin-left: 1rem;\n      display: inline;\n      float: right;\n      width: 30%;\n    }\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/others/Excel.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticStyle:{\"width\":\"100%\"}},[_c('div',{staticClass:\"option-area\"},[_c('a-upload',{staticClass:\"upload-area\",attrs:{\"fileList\":_vm.fileList,\"remove\":_vm.handleRemove,\"disabled\":_vm.fileList.length === 1,\"beforeUpload\":_vm.beforeUpload}},[_c('a-button',[_c('a-icon',{attrs:{\"type\":\"upload\"}}),_vm._v(\" 选择.xlsx文件\\n      \")],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"button-area\"},[_c('a-button',{staticStyle:{\"margin-right\":\".5rem\"},attrs:{\"type\":\"primary\"},on:{\"click\":_vm.downloadTemplate}},[_vm._v(\"\\n        模板下载\\n      \")]),_vm._v(\" \"),_c('a-button',{staticStyle:{\"margin-right\":\".5rem\"},on:{\"click\":_vm.exportExcel}},[_vm._v(\"\\n        导出Excel\\n      \")]),_vm._v(\" \"),_c('a-button',{attrs:{\"disabled\":_vm.fileList.length === 0,\"loading\":_vm.uploading},on:{\"click\":_vm.handleUpload}},[_vm._v(\"\\n        \"+_vm._s(_vm.uploading ? '导入中' : '导入Excel')+\"\\n      \")])],1)],1),_vm._v(\" \"),_c('a-card',{staticClass:\"card-area\",attrs:{\"bordered\":false}},[_c('a-table',{ref:\"TableInfo\",attrs:{\"columns\":_vm.columns,\"dataSource\":_vm.dataSource,\"pagination\":_vm.pagination,\"loading\":_vm.loading,\"scroll\":{ x: 900 }},on:{\"change\":_vm.handleTableChange}})],1),_vm._v(\" \"),_c('import-result',{attrs:{\"importData\":_vm.importData,\"errors\":_vm.errors,\"times\":_vm.times,\"importResultVisible\":_vm.importResultVisible},on:{\"close\":_vm.handleClose}})],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-b0b93f24\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/others/Excel.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-b0b93f24\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Excel.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Excel.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Excel.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-b0b93f24\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Excel.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-b0b93f24\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/others/Excel.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}